!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";var i,n;s.r(e),function(t){t[t.None=0]="None",t[t.BronzeMedal=1]="BronzeMedal",t[t.GoldMedal=2]="GoldMedal",t[t.SilverMedal=3]="SilverMedal",t[t.Alert=4]="Alert",t[t.Crown=5]="Crown",t[t.Ammo=6]="Ammo",t[t.Armour=7]="Armour",t[t.Barber=8]="Barber",t[t.Clothes=9]="Clothes",t[t.Franklin=10]="Franklin",t[t.Bike=11]="Bike",t[t.Car=12]="Car",t[t.Gun=13]="Gun",t[t.Heart=14]="Heart",t[t.Makeup=15]="Makeup",t[t.Mask=16]="Mask",t[t.Michael=17]="Michael",t[t.Star=18]="Star",t[t.Tatoo=19]="Tatoo",t[t.Trevor=20]="Trevor",t[t.Lock=21]="Lock",t[t.Tick=22]="Tick"}(i||(i={})),function(t){t[t.ChaletLondon=0]="ChaletLondon",t[t.HouseScript=1]="HouseScript",t[t.Monospace=2]="Monospace",t[t.CharletComprimeColonge=4]="CharletComprimeColonge",t[t.Pricedown=7]="Pricedown"}(n||(n={}));class h{constructor(){this.enabled=!0}}class o{constructor(t,e,s,i=255){this.R=t,this.G=e,this.B=s,this.A=i}}o.Empty=new o(0,0,0,0),o.Transparent=new o(0,0,0,0),o.Black=new o(0,0,0,255),o.White=new o(255,255,255,255),o.WhiteSmoke=new o(245,245,245,255);class r{static playSound(t,e){mp.game.audio.playSound(-1,t,e,!1,0,!0)}}class a{constructor(){this.handlers=[]}on(t){this.handlers.push(t)}off(t){this.handlers=this.handlers.filter(e=>e!==t)}emit(...t){this.handlers.slice(0).forEach(e=>e(...t))}expose(){return this}}class c{static parse(t){if(Array.isArray(t)){const[e,s]=t;return new c(e,s)}if("object"==typeof t&&t.x&&t.y)return new c(t.x,t.y);if("string"==typeof t&&-1!==t.indexOf(",")){const[e,s]=t.split(",").map(parseFloat);return new c(e,s)}return new c(0,0)}constructor(t=0,e=0){this.x=t,this.y=e}}const l=mp.game.graphics.getScreenActiveResolution(0,0),m={width:l.x,height:l.y};class d{constructor(t=0,e=0){this.width=t,this.height=e}}const u=()=>{let t="";for(let e=0;e<32;e+=1)switch(e){case 8:case 20:t+="-",t+=(16*Math.random()|0).toString(16);break;case 12:t+="-",t+="4";break;case 16:t+="-",t+=(4*Math.random()|8).toString(16);break;default:t+=(16*Math.random()|0).toString(16)}return t};class g extends h{constructor(t,e,s){super(),this.enabled=!0,this.pos=t,this.size=e,this.color=s}draw(t,e,s){t||(t=new c(0,0)),e||s||(t=new c(this.pos.x+t.x,this.pos.y+t.x),e=this.size,s=this.color);const i=e.width/1280,n=e.height/720,h=t.x/1280+.5*i,o=t.y/720+.5*n;mp.game.graphics.drawRect(h,o,i,n,s.R,s.G,s.B,s.A)}}class f extends g{constructor(t,e,s){super(t,e,s)}draw(t,e,s){t||(t=new c),!t||e||s||(t=new c(this.pos.x+t.x,this.pos.y+t.y),e=this.size,s=this.color);const i=1080*(m.width/m.height),n=e.width/i,h=e.height/1080,o=t.x/i+.5*n,r=t.y/1080+.5*h;mp.game.graphics.drawRect(o,r,n,h,s.R,s.G,s.B,s.A)}}const p=t=>"string"!=typeof t;class _ extends h{constructor(t,e,s,i,n,h){super(),this.caption=t,this.pos=e,this.scale=s,this.color=i||new o(255,255,255,255),this.font=n||0,this.centered=h||!1}draw(t,e,s,i,n,h){!p(t)||e||s||i||n||h||(e=new c(this.pos.x+t.width,this.pos.y+t.height),s=this.scale,i=this.color,n=this.font,h=this.centered);const o=e.x/1280,r=e.y/720;mp.game.ui.setTextFont(+n),mp.game.ui.setTextScale(s,s),mp.game.ui.setTextColour(i.R,i.G,i.B,i.A),mp.game.ui.setTextCentre(h),mp.game.ui.setTextEntry("STRING"),p(t)||x.addLongString(t),mp.game.ui.drawText(o,r)}}var w;!function(t){t[t.Left=0]="Left",t[t.Centered=1]="Centered",t[t.Right=2]="Right"}(w||(w={}));class x extends _{constructor(t,e,s,i,n,h){super(t,e,s,i||new o(255,255,255),n||0,!1),this.textAlignment=w.Left,h&&(this.textAlignment=h)}draw(t,e,s,i,n,h,o,r,a){let l=t,u=h,g=h;t||(t=new d(0,0)),t&&!e&&(g=this.textAlignment,l=this.caption,e=new c(this.pos.x+t.Width,this.pos.y+t.Height),s=this.scale,i=this.color,n=this.font,1==u||0==u?u=this.centered:(u=void 0,o=this.dropShadow,r=this.outline,a=this.wordWrap));const f=1080*(m.width/m.height),p=this.pos.x/f,_=this.pos.y/1080;if(mp.game.ui.setTextFont(parseInt(n)),mp.game.ui.setTextScale(1,s),mp.game.ui.setTextColour(i.R,i.G,i.B,i.A),void 0!==u)mp.game.ui.setTextCentre(u);else{switch(o&&mp.game.ui.setTextDropshadow(2,0,0,0,0),r&&console.warn("not working!"),g){case w.Centered:mp.game.ui.setTextCentre(!0);break;case w.Right:mp.game.ui.setTextRightJustify(!0),mp.game.ui.setTextWrap(0,p)}if(a){const t=(this.pos.x+a.Width)/f;mp.game.ui.setTextWrap(p,t)}}mp.game.ui.setTextEntry("STRING"),x.addLongString(l),mp.game.ui.drawText(p,_)}static addLongString(t){for(var e=0;e<t.length;e+=99){const s=t.substr(e,Math.min(99,t.length-e));mp.game.ui.addTextComponentSubstringPlayerName(s)}}}class I{set textureDict(t){this._textureDict=t,this.isTextureDictionaryLoaded||this.loadTextureDictionary()}get textureDict(){return this._textureDict}get isTextureDictionaryLoaded(){return mp.game.graphics.hasStreamedTextureDictLoaded(this._textureDict)}constructor(t,e,s,i,n=0,h=new o(255,255,255)){this.textureDict=t,this.textureName=e,this.pos=s,this.size=i,this.heading=n,this.color=h,this.visible=!0}loadTextureDictionary(){for(mp.game.graphics.requestStreamedTextureDict(this._textureDict,!0);!this.isTextureDictionaryLoaded;)mp.game.wait(0)}draw(t,e,s,i,n,h,o){t=t||this.textureDict,e=e||this.textureName,s=s||this.pos,i=i||this.size,n=n||this.heading,h=h||this.color,(o=o||!0)&&(mp.game.graphics.hasStreamedTextureDictLoaded(t)||mp.game.graphics.requestStreamedTextureDict(t,!0));const r=1080*(m.width/m.height),a=this.size.width/r,c=this.size.height/1080,l=this.pos.x/r+.5*a,d=this.pos.y/1080+.5*c;mp.game.graphics.drawSprite(t,e,l,d,a,c,n,h.R,h.G,h.B,h.A)}}class S{constructor(t,e=""){this.id=u(),this.backColor=S.defaultBackColor,this.highlightedBackColor=S.defaultHighlightedBackColor,this.foreColor=S.defaultForeColor,this.highlightedForeColor=S.defaultHighlightedForeColor,this.rightLabel="",this.leftBadge=i.None,this.rightBadge=i.None,this.enabled=!0,this._rectangle=new f(new c(0,0),new d(431,38),new o(150,0,0,0)),this._text=new x(t,new c(8,0),.33,o.WhiteSmoke,n.ChaletLondon,w.Left),this.description=e,this._selectedSprite=new I("commonmenu","gradient_nav",new c(0,0),new d(431,38)),this._badgeLeft=new I("commonmenu","",new c(0,0),new d(40,40)),this._badgeRight=new I("commonmenu","",new c(0,0),new d(40,40)),this._labelText=new x("",new c(0,0),.35,o.White,0,w.Right)}get text(){return this._text.caption}set text(t){this._text.caption=t}setVerticalPosition(t){this._rectangle.pos=new c(this.offset.x,t+144+this.offset.y),this._selectedSprite.pos=new c(0+this.offset.x,t+144+this.offset.y),this._text.pos=new c(8+this.offset.x,t+147+this.offset.y),this._badgeLeft.pos=new c(0+this.offset.x,t+142+this.offset.y),this._badgeRight.pos=new c(385+this.offset.x,t+142+this.offset.y),this._labelText.pos=new c(420+this.offset.x,t+148+this.offset.y)}addEvent(t,...e){this._event={event:t,args:e}}fireEvent(){this._event&&mp.events.call(this._event.event,this,...this._event.args)}draw(){this._rectangle.size=new d(431+this.parent.widthOffset,38),this._selectedSprite.size=new d(431+this.parent.widthOffset,38),this.hovered&&!this.selected&&(this._rectangle.color=new o(255,255,255,20),this._rectangle.draw()),this._selectedSprite.color=this.selected?this.highlightedBackColor:this.backColor,this._selectedSprite.draw(),this._text.color=this.enabled?this.selected?this.highlightedForeColor:this.foreColor:new o(163,159,148),this.leftBadge!=i.None?(this._text.pos=new c(35+this.offset.x,this._text.pos.y),this._badgeLeft.textureDict=this.badgeToSpriteLib(this.leftBadge),this._badgeLeft.textureName=this.badgeToSpriteName(this.leftBadge,this.selected),this.isBagdeWhiteSprite(this.leftBadge)?this.enabled?this._badgeLeft.color=this.selected?this.highlightedForeColor:this.foreColor:this._badgeLeft.color=new o(163,159,148):this._badgeLeft.color=o.White,this._badgeLeft.draw()):this._text.pos=new c(8+this.offset.x,this._text.pos.y),this.rightBadge!=i.None&&(this._badgeRight.pos=new c(385+this.offset.x+this.parent.widthOffset,this._badgeRight.pos.y),this._badgeRight.textureDict=this.badgeToSpriteLib(this.rightBadge),this._badgeRight.textureName=this.badgeToSpriteName(this.rightBadge,this.selected),this.isBagdeWhiteSprite(this.rightBadge)?this.enabled?this._badgeRight.color=this.selected?this.highlightedForeColor:this.foreColor:this._badgeRight.color=new o(163,159,148):this._badgeRight.color=o.White,this._badgeRight.draw()),this.rightLabel&&""!==this.rightLabel&&(this._labelText.pos=new c(420+this.offset.x+this.parent.widthOffset,this._labelText.pos.y),this._labelText.caption=this.rightLabel,this._labelText.color=this._text.color=this.enabled?this.selected?this.highlightedForeColor:this.foreColor:new o(163,159,148),this._labelText.draw()),this._text.draw()}setLeftBadge(t){this.leftBadge=t}setRightBadge(t){this.rightBadge=t}setRightLabel(t){this.rightLabel=t}badgeToSpriteLib(t){return"commonmenu"}badgeToSpriteName(t,e){switch(t){case i.None:return"";case i.BronzeMedal:return"mp_medal_bronze";case i.GoldMedal:return"mp_medal_gold";case i.SilverMedal:return"medal_silver";case i.Alert:return"mp_alerttriangle";case i.Crown:return"mp_hostcrown";case i.Ammo:return e?"shop_ammo_icon_b":"shop_ammo_icon_a";case i.Armour:return e?"shop_armour_icon_b":"shop_armour_icon_a";case i.Barber:return e?"shop_barber_icon_b":"shop_barber_icon_a";case i.Clothes:return e?"shop_clothing_icon_b":"shop_clothing_icon_a";case i.Franklin:return e?"shop_franklin_icon_b":"shop_franklin_icon_a";case i.Bike:return e?"shop_garage_bike_icon_b":"shop_garage_bike_icon_a";case i.Car:return e?"shop_garage_icon_b":"shop_garage_icon_a";case i.Gun:return e?"shop_gunclub_icon_b":"shop_gunclub_icon_a";case i.Heart:return e?"shop_health_icon_b":"shop_health_icon_a";case i.Lock:return"shop_lock";case i.Makeup:return e?"shop_makeup_icon_b":"shop_makeup_icon_a";case i.Mask:return e?"shop_mask_icon_b":"shop_mask_icon_a";case i.Michael:return e?"shop_michael_icon_b":"shop_michael_icon_a";case i.Star:return"shop_new_star";case i.Tatoo:return e?"shop_tattoos_icon_b":"shop_tattoos_icon_";case i.Tick:return"shop_tick_icon";case i.Trevor:return e?"shop_trevor_icon_b":"shop_trevor_icon_a";default:return""}}isBagdeWhiteSprite(t){switch(t){case i.Lock:case i.Tick:case i.Crown:return!0;default:return!1}}badgeToColor(t,e){switch(t){case i.Lock:case i.Tick:case i.Crown:return e?new o(255,0,0,0):new o(255,255,255,255);default:return new o(255,255,255,255)}}}S.defaultBackColor=o.Empty,S.defaultHighlightedBackColor=o.White,S.defaultForeColor=o.WhiteSmoke,S.defaultHighlightedForeColor=o.Black;class O extends S{constructor(t,e=!1,s=""){super(t,s),this.onCheckedChanged=new a,this.checked=!1,this._checkedSprite=new I("commonmenu","shop_box_blank",new c(410,95),new d(50,50)),this.checked=e}get checkedChanged(){return this.onCheckedChanged.expose()}setVerticalPosition(t){super.setVerticalPosition(t),this._checkedSprite.pos=new c(380+this.offset.x+this.parent.widthOffset,t+138+this.offset.y)}draw(){super.draw(),this._checkedSprite.pos=this._checkedSprite.pos=new c(380+this.offset.x+this.parent.widthOffset,this._checkedSprite.pos.y);const t=this.highlightedForeColor==S.defaultHighlightedForeColor;this.selected&&t?this._checkedSprite.textureName=this.checked?"shop_box_tickb":"shop_box_blankb":this._checkedSprite.textureName=this.checked?"shop_box_tick":"shop_box_blank",this._checkedSprite.color=this.enabled?this.selected&&!t?this.highlightedForeColor:this.foreColor:new o(163,159,148),this._checkedSprite.draw()}}class b{static measureStringWidthNoConvert(t){return mp.game.ui.setTextEntryForWidth("STRING"),x.addLongString(t),mp.game.ui.setTextFont(0),mp.game.ui.setTextScale(.35,.35),mp.game.ui.getTextScreenWidth(!1)}static measureString(t){const e=1080*(m.width/m.height);return b.measureStringWidthNoConvert(t)*e}}class R{constructor(t="",e=null){this.id=u(),this.displayText=t,this.data=e}}class C{constructor(t){if(0===t.length)throw new Error("ItemsCollection cannot be empty");this.items=t}length(){return this.items.length}getListItems(){const t=[];for(const e of this.items)e instanceof R?t.push(e):"string"==typeof e&&t.push(new R(e.toString()));return t}}class y extends S{constructor(t,e="",s=new C([]),i=0){super(t,e),this.onListChanged=new a,this.currOffset=0,this._collection=[],this.scrollingEnabled=!0,this.holdTimeBeforeScroll=200,this._index=0,this.collection=s.getListItems(),this.index=i,this._arrowLeft=new I("commonmenu","arrowleft",new c(110,105),new d(30,30)),this._arrowRight=new I("commonmenu","arrowright",new c(280,105),new d(30,30)),this._itemText=new x("",new c(290,104),.35,o.White,n.ChaletLondon,w.Right)}get collection(){return this._collection}set collection(t){if(!t)throw new Error("The collection can't be null");this._collection=t}set selectedItem(t){const e=this.collection.findIndex(e=>e.id===t.id);this.index=Math.max(e,0)}get selectedItem(){return this.collection.length?this.collection[this.index]:null}get selectedValue(){return this.selectedItem?null==this.selectedItem.data?this.selectedItem.displayText:this.selectedItem.data:null}get listChanged(){return this.onListChanged.expose()}get index(){return null==this.collection?-1:null==this.collection||this.collection.length?this._index%this.collection.length:-1}set index(t){if(null==this.collection)return;if(null!=this.collection&&0==this.collection.length)return;this._index=1e5-1e5%this.collection.length+t;const e=this.collection.length>=this.index?this.collection[this.index].displayText:" ";this.currOffset=b.measureString(e)}setCollection(t){this.collection=t.getListItems()}setCollectionItem(t,e,s=!0){if(t>this.collection.length)throw new Error("Index out of bounds");"string"==typeof e&&(e=new R(e)),this.collection.splice(t,1,e),s&&(this.index=0)}setVerticalPosition(t){this._arrowLeft.pos=new c(300+this.offset.x+this.parent.widthOffset,147+t+this.offset.y),this._arrowRight.pos=new c(400+this.offset.x+this.parent.widthOffset,147+t+this.offset.y),this._itemText.pos=new c(300+this.offset.x+this.parent.widthOffset,t+147+this.offset.y),super.setVerticalPosition(t)}setRightLabel(t){return this}setRightBadge(t){return this}draw(){super.draw();const t=this.collection.length>=this.index?this.collection[this.index].displayText:" ",e=this.currOffset;this._itemText.caption=t,this._itemText.color=this.enabled?this.selected?this.highlightedForeColor:this.foreColor:new o(163,159,148),this._arrowLeft.color=this.enabled?this.selected?this.highlightedForeColor:this.foreColor:new o(163,159,148),this._arrowRight.color=this.enabled?this.selected?this.highlightedForeColor:this.foreColor:new o(163,159,148),this._arrowLeft.pos=new c(375-e+this.offset.x+this.parent.widthOffset,this._arrowLeft.pos.y),this.selected?(this._arrowLeft.draw(),this._arrowRight.draw(),this._itemText.pos=new c(405+this.offset.x+this.parent.widthOffset,this._itemText.pos.y)):this._itemText.pos=new c(420+this.offset.x+this.parent.widthOffset,this._itemText.pos.y),this._itemText.draw()}}class v extends S{get index(){return this._index%this._items.length}set index(t){this._index=1e8-1e8%this._items.length+t}constructor(t,e,s,i="",n=!1){super(t,i),this._items=e,this._arrowLeft=new I("commonmenutu","arrowleft",new c(0,105),new d(15,15)),this._arrowRight=new I("commonmenutu","arrowright",new c(0,105),new d(15,15)),this._rectangleBackground=new f(new c(0,0),new d(150,9),new o(4,32,57,255)),this._rectangleSlider=new f(new c(0,0),new d(75,9),new o(57,116,200,255)),this._rectangleDivider=new f(new c(0,0),new d(2.5,20),n?o.WhiteSmoke:o.Transparent),this.index=s}setVerticalPosition(t){this._rectangleBackground.pos=new c(250+this.offset.x+this.parent.widthOffset,t+158.5+this.offset.y),this._rectangleSlider.pos=new c(250+this.offset.x+this.parent.widthOffset,t+158.5+this.offset.y),this._rectangleDivider.pos=new c(323.5+this.offset.x+this.parent.widthOffset,t+153+this.offset.y),this._arrowLeft.pos=new c(235+this.offset.x+this.parent.widthOffset,155.5+t+this.offset.y),this._arrowRight.pos=new c(400+this.offset.x+this.parent.widthOffset,155.5+t+this.offset.y),super.setVerticalPosition(t)}indexToItem(t){return this._items[t]}draw(){super.draw(),this._arrowLeft.color=this.enabled?this.selected?o.Black:o.WhiteSmoke:new o(163,159,148),this._arrowRight.color=this.enabled?this.selected?o.Black:o.WhiteSmoke:new o(163,159,148);let t=(this._rectangleBackground.size.width-this._rectangleSlider.size.width)/(this._items.length-1)*this.index;this._rectangleSlider.pos=new c(250+this.offset.x+t+ +this.parent.widthOffset,this._rectangleSlider.pos.y),this.selected&&(this._arrowLeft.draw(),this._arrowRight.draw()),this._rectangleBackground.draw(),this._rectangleSlider.draw(),this._rectangleDivider.draw()}setRightBadge(t){}setRightLabel(t){}}class T extends g{constructor(t,e,s){super(t,e,s),this.items=[]}addItem(t){this.items.push(t)}draw(t){if(!this.enabled)return;t=t||new c;const e=1080*(m.width/m.height),s=this.size.width/e,i=this.size.height/1080,n=(this.pos.x+t.x)/e+.5*s,h=(this.pos.y+t.y)/1080+.5*i;mp.game.graphics.drawRect(n,h,s,i,this.color.R,this.color.G,this.color.B,this.color.A);for(let e of this.items)e.Draw(new d(this.pos.x+t.x,this.pos.y+t.y))}}s.d(e,"Menu",function(){return D}),s.d(e,"UIMenuItem",function(){return S}),s.d(e,"UIMenuListItem",function(){return y}),s.d(e,"UIMenuCheckboxItem",function(){return O}),s.d(e,"UIMenuSliderItem",function(){return v}),s.d(e,"BadgeStyle",function(){return i}),s.d(e,"Point",function(){return c}),s.d(e,"Size",function(){return d}),s.d(e,"Color",function(){return o}),s.d(e,"Font",function(){return n}),s.d(e,"ItemsCollection",function(){return C}),s.d(e,"ListItem",function(){return R});class D{constructor(t,e,s,i,h){this.counterPretext="",this.counterOverride=void 0,this.lastUpDownNavigation=0,this.lastLeftRightNavigation=0,this.extraOffset=0,this.safezoneOffset=new c(0,0),this.maxItemsOnScreen=9,this.mouseEdgeEnabled=!0,this._activeItem=1e3,this._justOpened=!0,this._maxItem=this.maxItemsOnScreen,this.indexChange=new a,this.listChange=new a,this.sliderChange=new a,this.sliderSelect=new a,this.checkboxChange=new a,this.itemSelect=new a,this.menuOpen=new a,this.menuClose=new a,this.menuChange=new a,this.id=u(),this.AUDIO_LIBRARY="HUD_FRONTEND_DEFAULT_SOUNDSET",this.AUDIO_UPDOWN="NAV_UP_DOWN",this.AUDIO_LEFTRIGHT="NAV_LEFT_RIGHT",this.AUDIO_SELECT="SELECT",this.AUDIO_BACK="BACK",this.AUDIO_ERROR="ERROR",this.widthOffset=0,this.visible=!0,this.mouseControlsEnabled=!1,this.menuItems=[],s instanceof c||(s=c.parse(s)),this.title=t,this.subtitle=e,this.spriteLibrary=i||"commonmenu",this.spriteName=h||"interaction_bgd",this.offset=new c(s.x,s.y),this.children=new Map,this._mainMenu=new T(new c(0,0),new d(700,500),new o(0,0,0,0)),this._logo=new I(this.spriteLibrary,this.spriteName,new c(0+this.offset.x,0+this.offset.y),new d(431,107)),this._title=new x(this.title,new c(215+this.offset.x,20+this.offset.y),1.15,new o(255,255,255),1,w.Centered),this._mainMenu.addItem(this._title),""!==this.subtitle&&(this._mainMenu.addItem(new f(new c(0+this.offset.x,107+this.offset.y),new d(431,37),new o(0,0,0,255))),this._mainMenu.addItem(this._subtitle=new x(this.subtitle,new c(8+this.offset.x,110+this.offset.y),.35,new o(255,255,255),0,w.Left)),this.subtitle.startsWith("~")&&(this.counterPretext=this.subtitle.substr(0,3)),this._counterText=new x("",new c(425+this.offset.x,110+this.offset.y),.35,new o(255,255,255),0,w.Right),this.extraOffset+=37),this._upAndDownSprite=new I("commonmenu","shop_arrows_upanddown",new c(190+this.offset.x,147+37*(this.maxItemsOnScreen+1)+this.offset.y-37+this.extraOffset),new d(50,50)),this._extraRectangleUp=new f(new c(0+this.offset.x,144+38*(this.maxItemsOnScreen+1)+this.offset.y-37+this.extraOffset),new d(431,18),new o(0,0,0,200)),this._extraRectangleDown=new f(new c(0+this.offset.x,162+38*(this.maxItemsOnScreen+1)+this.offset.y-37+this.extraOffset),new d(431,18),new o(0,0,0,200)),this._descriptionBar=new f(new c(this.offset.x,123),new d(431,4),o.Black),this._descriptionRectangle=new I("commonmenu","gradient_bgd",new c(this.offset.x,127),new d(431,30)),this._descriptionText=new x("Description",new c(this.offset.x+5,125),.35,new o(255,255,255,255),n.ChaletLondon,w.Left),this._background=new I("commonmenu","gradient_bgd",new c(this.offset.x,144+this.offset.y-37+this.extraOffset),new d(290,25)),mp.events.add("render",this.render.bind(this))}get currentSelection(){return this._activeItem%this.menuItems.length}set currentSelection(t){this.menuItems[this._activeItem%this.menuItems.length].selected=!1,this._activeItem=1e3-1e3%this.menuItems.length+t,this.currentSelection>this._maxItem?(this._maxItem=this.currentSelection,this._minItem=this.currentSelection-this.maxItemsOnScreen):this.currentSelection<this._minItem&&(this._maxItem=this.maxItemsOnScreen+this.currentSelection,this._minItem=this.currentSelection)}recalculateDescriptionPosition(){this._descriptionBar.pos=new c(this.offset.x,112+this.extraOffset+this.offset.y),this._descriptionRectangle.pos=new c(this.offset.x,112+this.extraOffset+this.offset.y),this._descriptionText.pos=new c(this.offset.x+8,118+this.extraOffset+this.offset.y),this._descriptionBar.size=new d(431+this.widthOffset,4),this._descriptionRectangle.size=new d(431+this.widthOffset,30);let t=this.menuItems.length;t>this.maxItemsOnScreen+1&&(t=this.maxItemsOnScreen+2),this._descriptionBar.pos=new c(this.offset.x,38*t+this._descriptionBar.pos.y),this._descriptionRectangle.pos=new c(this.offset.x,38*t+this._descriptionRectangle.pos.y),this._descriptionText.pos=new c(this.offset.x+8,38*t+this._descriptionText.pos.y)}setMenuWidthOffset(t){if(this.widthOffset=t,null!=this._logo&&(this._logo.size=new d(431+this.widthOffset,107)),this._mainMenu.items[0].pos=new c((this.widthOffset+this.offset.x+431)/2,20+this.offset.y),this._counterText&&(this._counterText.pos=new c(425+this.offset.x+t,110+this.offset.y)),this._mainMenu.items.length>=2){this._mainMenu.items[1].size=new d(431+this.widthOffset,37)}}addItem(t){this._justOpened&&(this._justOpened=!1),t.offset=this.offset,t.parent=this,t.setVerticalPosition(25*this.menuItems.length-37+this.extraOffset),this.menuItems.push(t),t.description=this.formatDescription(t.description),this.refreshIndex(),this.recalculateDescriptionPosition()}refreshIndex(){if(!this.menuItems.length)return this._activeItem=1e3,this._maxItem=this.maxItemsOnScreen,void(this._minItem=0);for(let t=0;t<this.menuItems.length;t++)this.menuItems[t].selected=!1;this._activeItem=1e3-1e3%this.menuItems.length,this._maxItem=this.maxItemsOnScreen,this._minItem=0}clear(){this.menuItems=[],this.recalculateDescriptionPosition()}open(){r.playSound(this.AUDIO_BACK,this.AUDIO_LIBRARY),this.visible=!0,this._justOpened=!0,this.menuOpen.emit()}close(){r.playSound(this.AUDIO_BACK,this.AUDIO_LIBRARY),this.visible=!1,this.refreshIndex(),this.menuClose.emit()}set subtitleCaption(t){this.subtitle=t,this._subtitle.caption=t}goLeft(){if(this.menuItems[this.currentSelection]instanceof y||this.menuItems[this.currentSelection]instanceof v)if(this.menuItems[this.currentSelection]instanceof y){const t=this.menuItems[this.currentSelection];if(!t.collection.length)return;t.index--,r.playSound(this.AUDIO_LEFTRIGHT,this.AUDIO_LIBRARY),this.listChange.emit(t,t.index)}else if(this.menuItems[this.currentSelection]instanceof v){const t=this.menuItems[this.currentSelection];t.index--,r.playSound(this.AUDIO_LEFTRIGHT,this.AUDIO_LIBRARY),this.sliderChange.emit(t,t.index,t.indexToItem(t.index))}}goRight(){if(this.menuItems[this.currentSelection]instanceof y||this.menuItems[this.currentSelection]instanceof v)if(this.menuItems[this.currentSelection]instanceof y){const t=this.menuItems[this.currentSelection];if(!t.collection.length)return;t.index++,r.playSound(this.AUDIO_LEFTRIGHT,this.AUDIO_LIBRARY),this.listChange.emit(t,t.index)}else if(this.menuItems[this.currentSelection]instanceof v){const t=this.menuItems[this.currentSelection];t.index++,r.playSound(this.AUDIO_LEFTRIGHT,this.AUDIO_LIBRARY),this.sliderChange.emit(t,t.index,t.indexToItem(t.index))}}selectItem(){if(!this.menuItems[this.currentSelection].enabled)return void r.playSound(this.AUDIO_ERROR,this.AUDIO_LIBRARY);const t=this.menuItems[this.currentSelection];if(this.menuItems[this.currentSelection]instanceof O)t.checked=!t.checked,r.playSound(this.AUDIO_SELECT,this.AUDIO_LIBRARY),this.checkboxChange.emit(t,t.checked);else if(r.playSound(this.AUDIO_SELECT,this.AUDIO_LIBRARY),this.itemSelect.emit(t,this.currentSelection),this.children.has(t.id)){const e=this.children.get(t.id);this.visible=!1,e.visible=!0,e._justOpened=!0,e.menuOpen.emit(),this.menuChange.emit(e,!0)}t.fireEvent()}getMousePosition(t=!1){const e=m.width,s=m.height,i=mp.gui.cursor.position;if(!t)return i;const[n,h]=i;return[n/e,h/s]}getScreenResolutionMantainRatio(){const t=m.width,e=m.height;return new d(1080*(t/e),1080)}isMouseInBounds(t,e){this.getScreenResolutionMantainRatio();const[s,i]=this.getMousePosition();return s>=t.x&&s<=t.x+e.width&&i>t.y&&i<t.y+e.height}isMouseInListItemArrows(t,e,s){mp.game.invoke("0x54ce8ac98e120cab".toUpperCase(),"jamyfafi"),mp.game.ui.addTextComponentSubstringPlayerName(t.Text);const i=this.getScreenResolutionMantainRatio(),{width:n,height:h}=i;var o=1080*(n/h);const r=5+mp.game.invoke("0x85f061da64ed2f67".toUpperCase(),0)*o*.35+10,a=431-r;return this.isMouseInBounds(e,new d(r,38))?1:this.isMouseInBounds(new c(e.X+r,e.Y),new d(a,38))?2:0}processMouse(){if(!this.visible||this._justOpened||0==this.menuItems.length||!this.mouseControlsEnabled)return void this.menuItems.filter(t=>t.hovered).forEach(t=>t.hovered=!1);mp.gui.cursor.visible||(mp.gui.cursor.visible=!0);let t=this.menuItems.length-1,e=0;this.menuItems.length>this.maxItemsOnScreen+1&&(t=this._maxItem),this.isMouseInBounds(new c(0,0),new d(30,1080))&&this.mouseEdgeEnabled?(mp.game.cam.setGameplayCamRelativeHeading(mp.game.cam.getGameplayCamRelativeHeading()+5),mp.game.ui.setCursorSprite(6)):this.isMouseInBounds(new c(this.getScreenResolutionMantainRatio().width-30,0),new d(30,1080))&&this.mouseEdgeEnabled?(mp.game.cam.setGameplayCamRelativeHeading(mp.game.cam.getGameplayCamRelativeHeading()-5),mp.game.ui.setCursorSprite(7)):this.mouseEdgeEnabled&&mp.game.ui.setCursorSprite(1);for(let i=this._minItem;i<=t;i++){let t=this.offset.x,n=this.offset.y+144-37+this.extraOffset+38*e,h=431+this.widthOffset;const o=38,a=this.menuItems[i];if(this.isMouseInBounds(new c(t,n),new d(h,o))){if(a.hovered=!0,mp.game.controls.isControlJustPressed(0,24)||mp.game.controls.isDisabledControlJustPressed(0,24))if(a.selected&&a.enabled)if(this.menuItems[i]instanceof y&&this.isMouseInListItemArrows(this.menuItems[i],new c(t,n),0)>0){switch(this.isMouseInListItemArrows(this.menuItems[i],new c(t,n),0)){case 1:r.playSound(this.AUDIO_SELECT,this.AUDIO_LIBRARY),this.menuItems[i].fireEvent(),this.itemSelect.emit(this.menuItems[i],i);break;case 2:var s=this.menuItems[i];(null==s.Collection?s.Items.Count:s.Collection.Count)>0&&(s.Index++,r.playSound(this.AUDIO_LEFTRIGHT,this.AUDIO_LIBRARY),this.listChange.emit(s,s.Index))}}else this.selectItem();else a.selected?!a.enabled&&a.selected&&r.playSound(this.AUDIO_ERROR,this.AUDIO_LIBRARY):(this.currentSelection=i,r.playSound(this.AUDIO_UPDOWN,this.AUDIO_LIBRARY),this.indexChange.emit(this.currentSelection),this.selectItem())}else a.hovered=!1;e++}const i=144+38*(this.maxItemsOnScreen+1)+this.offset.y-37+this.extraOffset+this.safezoneOffset.y,n=this.safezoneOffset.x+this.offset.x;this.menuItems.length<=this.maxItemsOnScreen+1||(this.isMouseInBounds(new c(n,i),new d(431+this.widthOffset,18))?(this._extraRectangleUp.color=new o(30,30,30,255),(mp.game.controls.isControlJustPressed(0,24)||mp.game.controls.isDisabledControlJustPressed(0,24))&&(this.menuItems.length>this.maxItemsOnScreen+1?this.goUpOverflow():this.goUp())):this._extraRectangleUp.color=new o(0,0,0,200),this.isMouseInBounds(new c(n,i+18),new d(431+this.widthOffset,18))?(this._extraRectangleDown.color=new o(30,30,30,255),(mp.game.controls.isControlJustPressed(0,24)||mp.game.controls.isDisabledControlJustPressed(0,24))&&(this.menuItems.length>this.maxItemsOnScreen+1?this.goDownOverflow():this.goDown())):this._extraRectangleDown.color=new o(0,0,0,200))}processControl(){this.visible&&(this._justOpened?this._justOpened=!1:(mp.game.controls.isControlJustReleased(0,177)&&this.goBack(),this.menuItems.length&&(mp.game.controls.isControlPressed(0,172)&&this.lastUpDownNavigation+120<Date.now()?(this.lastUpDownNavigation=Date.now(),this.menuItems.length>this.maxItemsOnScreen+1?this.goUpOverflow():this.goUp()):mp.game.controls.isControlJustReleased(0,172)?this.lastUpDownNavigation=0:mp.game.controls.isControlPressed(0,173)&&this.lastUpDownNavigation+120<Date.now()?(this.lastUpDownNavigation=Date.now(),this.menuItems.length>this.maxItemsOnScreen+1?this.goDownOverflow():this.goDown()):mp.game.controls.isControlJustReleased(0,173)?this.lastUpDownNavigation=0:mp.game.controls.isControlPressed(0,174)&&this.lastLeftRightNavigation+100<Date.now()?(this.lastLeftRightNavigation=Date.now(),this.goLeft()):mp.game.controls.isControlJustReleased(0,174)?this.lastLeftRightNavigation=0:mp.game.controls.isControlPressed(0,175)&&this.lastLeftRightNavigation+100<Date.now()?(this.lastLeftRightNavigation=Date.now(),this.goRight()):mp.game.controls.isControlJustReleased(0,175)?this.lastLeftRightNavigation=0:mp.game.controls.isControlJustPressed(0,201)&&this.selectItem())))}formatDescription(t){t.length>99&&(t=t.slice(0,99));const e=425+this.widthOffset;let s=0,i="";const n=t.split(" ");for(const t of n){const n=b.measureString(t);(s+=n)>e?(i+="\n"+t+" ",s=n+b.measureString(" ")):(i+=t+" ",s+=b.measureString(" "))}return i}goUpOverflow(){this.menuItems.length<=this.maxItemsOnScreen+1||(this._activeItem%this.menuItems.length<=this._minItem?this._activeItem%this.menuItems.length==0?(this._minItem=this.menuItems.length-this.maxItemsOnScreen-1,this._maxItem=this.menuItems.length-1,this.menuItems[this._activeItem%this.menuItems.length].selected=!1,this._activeItem=1e3-1e3%this.menuItems.length,this._activeItem+=this.menuItems.length-1,this.menuItems[this._activeItem%this.menuItems.length].selected=!0):(this._minItem--,this._maxItem--,this.menuItems[this._activeItem%this.menuItems.length].selected=!1,this._activeItem--,this.menuItems[this._activeItem%this.menuItems.length].selected=!0):(this.menuItems[this._activeItem%this.menuItems.length].selected=!1,this._activeItem--,this.menuItems[this._activeItem%this.menuItems.length].selected=!0),r.playSound(this.AUDIO_UPDOWN,this.AUDIO_LIBRARY),this.indexChange.emit(this.currentSelection))}goUp(){this.menuItems.length>this.maxItemsOnScreen+1||(this.menuItems[this._activeItem%this.menuItems.length].selected=!1,this._activeItem--,this.menuItems[this._activeItem%this.menuItems.length].selected=!0,r.playSound(this.AUDIO_UPDOWN,this.AUDIO_LIBRARY),this.indexChange.emit(this.currentSelection))}goDownOverflow(){this.menuItems.length<=this.maxItemsOnScreen+1||(this._activeItem%this.menuItems.length>=this._maxItem?this._activeItem%this.menuItems.length==this.menuItems.length-1?(this._minItem=0,this._maxItem=this.maxItemsOnScreen,this.menuItems[this._activeItem%this.menuItems.length].selected=!1,this._activeItem=1e3-1e3%this.menuItems.length,this.menuItems[this._activeItem%this.menuItems.length].selected=!0):(this._minItem++,this._maxItem++,this.menuItems[this._activeItem%this.menuItems.length].selected=!1,this._activeItem++,this.menuItems[this._activeItem%this.menuItems.length].selected=!0):(this.menuItems[this._activeItem%this.menuItems.length].selected=!1,this._activeItem++,this.menuItems[this._activeItem%this.menuItems.length].selected=!0),r.playSound(this.AUDIO_UPDOWN,this.AUDIO_LIBRARY),this.indexChange.emit(this.currentSelection))}goDown(){this.menuItems.length>this.maxItemsOnScreen+1||(this.menuItems[this._activeItem%this.menuItems.length].selected=!1,this._activeItem++,this.menuItems[this._activeItem%this.menuItems.length].selected=!0,r.playSound(this.AUDIO_UPDOWN,this.AUDIO_LIBRARY),this.indexChange.emit(this.currentSelection))}goBack(){r.playSound(this.AUDIO_BACK,this.AUDIO_LIBRARY),this.visible=!1,null!=this.parentMenu&&(this.parentMenu.visible=!0,this.parentMenu._justOpened=!0,this.parentMenu.menuOpen.emit(),this.menuChange.emit(this.parentMenu,!1)),this.menuClose.emit()}bindMenuToItem(t,e){t.parentMenu=this,t.parentItem=e,this.children.set(e.id,t)}releaseMenuFromItem(t){if(!this.children.has(t.id))return!1;const e=this.children.get(t.id);return e.parentItem=null,e.parentMenu=null,this.children.delete(t.id),!0}render(){if(this.visible){if(this._justOpened&&(null==this._logo||this._logo.isTextureDictionaryLoaded||this._logo.loadTextureDictionary(),this._background.isTextureDictionaryLoaded||this._background.loadTextureDictionary(),this._descriptionRectangle.isTextureDictionaryLoaded||this._descriptionRectangle.loadTextureDictionary(),this._upAndDownSprite.isTextureDictionaryLoaded||this._upAndDownSprite.loadTextureDictionary()),this._mainMenu.draw(),this.processMouse(),this.processControl(),this._background.size=this.menuItems.length>this.maxItemsOnScreen+1?new d(431+this.widthOffset,38*(this.maxItemsOnScreen+1)):new d(431+this.widthOffset,38*this.menuItems.length),this._background.draw(),this.menuItems.length>0&&(this.menuItems[this._activeItem%this.menuItems.length].selected=!0,""!==this.menuItems[this._activeItem%this.menuItems.length].description.trim())){this.recalculateDescriptionPosition();let t=this.menuItems[this._activeItem%this.menuItems.length].description;this._descriptionText.caption=t;const e=this._descriptionText.caption.split("\n").length;this._descriptionRectangle.size=new d(431+this.widthOffset,25*e+15),this._descriptionBar.draw(),this._descriptionRectangle.draw(),this._descriptionText.draw()}if(this.menuItems.length<=this.maxItemsOnScreen+1){let t=0;for(const e of this.menuItems)e.setVerticalPosition(38*t-37+this.extraOffset),e.draw(),t++;this._counterText&&this.counterOverride&&(this._counterText.caption=this.counterPretext+this.counterOverride,this._counterText.draw())}else{let e=0;for(let s=this._minItem;s<=this._maxItem;s++){var t=this.menuItems[s];t.setVerticalPosition(38*e-37+this.extraOffset),t.draw(),e++}if(this._extraRectangleUp.size=new d(431+this.widthOffset,18),this._extraRectangleDown.size=new d(431+this.widthOffset,18),this._upAndDownSprite.pos=new c(190+this.offset.x+this.widthOffset/2,147+37*(this.maxItemsOnScreen+1)+this.offset.y-37+this.extraOffset),this._extraRectangleUp.draw(),this._extraRectangleDown.draw(),this._upAndDownSprite.draw(),this._counterText){if(this.counterOverride)this._counterText.caption=this.counterPretext+this.counterOverride;else{const t=this.currentSelection+1+" / "+this.menuItems.length;this._counterText.caption=this.counterPretext+t}this._counterText.draw()}}this._logo.draw()}}}}]);